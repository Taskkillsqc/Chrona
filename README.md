# Chrona

Chrona æ˜¯ä¸€ä¸ªåŸºäº LLM çš„æ™ºèƒ½æ—¥ç¨‹æé†’åŠ©æ‰‹ã€‚

## ğŸ†• v3.0 æ–°åŠŸèƒ½äº®ç‚¹

- ğŸ¤– **LLM å¤šæä¾›å•†æ”¯æŒ**: æ”¯æŒ Geminiã€DeepSeekã€OpenAIã€è‡ªå®šä¹‰ API ç«¯ç‚¹å’Œæœ¬åœ°æ¨¡å‹
- ğŸ  **æœ¬åœ°æ¨¡å‹æ”¯æŒ**: æ”¯æŒ GGUF æ ¼å¼çš„æœ¬åœ° LLM æ¨¡å‹ï¼ˆQwenã€LLaMAã€Gemma ç­‰ï¼‰âš ï¸ å®éªŒæ€§åŠŸèƒ½
- ğŸ”§ **çµæ´»çš„æ¨¡å‹é…ç½®**: ç”¨æˆ·å¯è‡ªå®šä¹‰ API URLã€æ¨¡å‹åç§°å’Œè¯·æ±‚å‚æ•°
- âš¡ **ç»Ÿä¸€çš„ LLM æ¥å£**: é€šè¿‡ç»Ÿä¸€æ¥å£è°ƒç”¨ä¸åŒçš„ LLM æä¾›å•†
- ğŸ›ï¸ **é«˜çº§å‚æ•°æ§åˆ¶**: æ”¯æŒæ¸©åº¦ã€æœ€å¤§ä»¤ç‰Œæ•°ã€top-p ç­‰å‚æ•°è°ƒæ•´
- ğŸ”— **è‡ªå®šä¹‰ API æ”¯æŒ**: å…¼å®¹ä»»ä½• OpenAI æ ¼å¼çš„ API ç«¯ç‚¹
- ğŸ”„ **å‘åå…¼å®¹**: å®Œå…¨å…¼å®¹ v2.x é…ç½®æ–‡ä»¶

## ğŸ†• v2.0 åŠŸèƒ½ç‰¹æ€§

- ğŸ’— **å¿ƒè·³åŒ…ç›‘æ§**: æ”¯æŒå‘ Uptime Kumaã€Healthchecks.io ç­‰ç›‘æ§æœåŠ¡å‘é€çŠ¶æ€æ›´æ–°
- ğŸŒ **å®Œæ•´REST API**: æä¾›ä¸°å¯Œçš„HTTPæ¥å£ï¼Œæ”¯æŒè¿œç¨‹ç›‘æ§å’Œæ§åˆ¶
- ğŸ“Š **å®æ—¶çŠ¶æ€ç›‘æ§**: é€šè¿‡APIå®æ—¶æŸ¥çœ‹ç¨‹åºè¿è¡ŒçŠ¶æ€ã€ç»Ÿè®¡ä¿¡æ¯å’Œå¿ƒè·³åŒ…çŠ¶æ€
- ğŸ”§ **è¿œç¨‹æ“ä½œ**: æ”¯æŒé€šè¿‡APIè¿œç¨‹è§¦å‘äº‹ä»¶è·å–ã€æé†’æ£€æŸ¥ç­‰æ“ä½œ
- ğŸ“š **è‡ªåŠ¨APIæ–‡æ¡£**: å†…ç½®Swagger UIå’ŒReDocæ–‡æ¡£ï¼Œå¼€ç®±å³ç”¨
- ğŸ§ª **æµ‹è¯•å·¥å…·**: æä¾›å®Œæ•´çš„åŠŸèƒ½æµ‹è¯•è„šæœ¬ï¼Œç¡®ä¿éƒ¨ç½²æ­£ç¡®

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ”„ **è‡ªåŠ¨åŒæ­¥**: æ¯ 10 åˆ†é’Ÿé€šè¿‡ CalDAV è·å–æ¥ä¸‹æ¥ 1 å°æ—¶çš„æ—¥ç¨‹
- ğŸ—‚ï¸ **å¤š CalDAV æ”¯æŒ**: åŒæ—¶æ”¯æŒå¤šä¸ªæ—¥å†æä¾›å•†ï¼ˆiCloudã€Googleã€Outlook ç­‰ï¼‰
- ğŸ¤– **AI åˆ†æ**: ä½¿ç”¨åœ¨çº¿ API æˆ–æœ¬åœ°æ¨¡å‹æ™ºèƒ½åˆ†ææ—¥ç¨‹é‡è¦æ€§å’Œæé†’éœ€æ±‚
- ğŸ  **æœ¬åœ° LLM æ”¯æŒ**: æ”¯æŒ GGUF æ ¼å¼æ¨¡å‹ï¼Œå®Œå…¨ç¦»çº¿è¿è¡Œï¼Œä¿æŠ¤éšç§ï¼ˆâš ï¸ å®éªŒæ€§åŠŸèƒ½ï¼Œæ ¼å¼é”™è¯¯ç‡è¾ƒé«˜ï¼‰
- ğŸ’¾ **æ•°æ®å­˜å‚¨**: æœ¬åœ° SQLite æ•°æ®åº“å­˜å‚¨åˆ†æç»“æœ
- ğŸ“± **æ™ºèƒ½é€šçŸ¥**: é€šè¿‡ Webhook å‘é€ä¸ªæ€§åŒ–æé†’é€šçŸ¥ï¼Œæ”¯æŒ Gotifyã€Slackã€é€šç”¨å’Œå®Œå…¨è‡ªå®šä¹‰æ ¼å¼
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²**: æ”¯æŒ Docker å’Œ docker-compose éƒ¨ç½²
- ğŸ”§ **çµæ´»é…ç½®**: æ”¯æŒå¤šç§ AI æ¨¡å‹å’Œ CalDAV æœåŠ¡
- ğŸ—‚ï¸ **å¤šæ—¥å†æ”¯æŒ**: è‡ªåŠ¨è¯†åˆ«å’Œæ˜¾ç¤ºäº‹ä»¶æ¥æºæ—¥å†åç§°ï¼ˆå¦‚ iCloud å°æ—¥å†ï¼‰
- ğŸ’— **å¿ƒè·³åŒ…ç›‘æ§**: å®šæœŸå‘ Uptime Kuma ç­‰ç›‘æ§æœåŠ¡å‘é€çŠ¶æ€æ›´æ–°
- ğŸŒ **REST API**: å®Œæ•´çš„ API æ¥å£æ”¯æŒè¿œç¨‹ç›‘æ§å’Œæ§åˆ¶
- ğŸ“Š **å®æ—¶çŠ¶æ€**: è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼Œæ”¯æŒå®æ—¶æŸ¥çœ‹ç¨‹åºçŠ¶æ€

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ”§ ç¯å¢ƒè¦æ±‚

- Python 3.7+
- Docker (å¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²)
- CalDAV è´¦æˆ· (å¦‚ iCloudã€Google Calendar ç­‰)
- AI API å¯†é’¥ (Gemini æˆ– DeepSeek)
- Webhook é€šçŸ¥æœåŠ¡ (å¦‚ Gotify)

### æœ¬åœ°è¿è¡Œ

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/Taskkillsqc/Chrona.git
   cd Chrona
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

3. **é…ç½®è®¾ç½®**
   
   å¤åˆ¶å¹¶ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š
   ```bash
   cp config.yaml.example config.yaml
   ```
   
   **âš ï¸ LLM é€‰æ‹©å»ºè®®**ï¼š
   - ğŸŒŸ **æ¨è**ï¼šä½¿ç”¨äº‘ç«¯ LLMï¼ˆGemini/DeepSeekï¼‰è·å¾—æœ€ä½³ç¨³å®šæ€§å’Œå‡†ç¡®æ€§
   - âš¡ **å®éªŒæ€§**ï¼šæœ¬åœ° LLM è™½ç„¶å…è´¹ä½†å¯èƒ½äº§ç”Ÿæ ¼å¼é”™è¯¯ï¼Œå½±å“æé†’åŠŸèƒ½
   
   ç¼–è¾‘ `config.yaml`ï¼š
   ```yaml
   # LLM é…ç½® (V3.0 æ–°æ ¼å¼)
   # é€‰æ‹©ä¸€ç§é…ç½®æ–¹å¼ï¼š
   
   # åœ¨çº¿ API é…ç½®ï¼ˆæ¨èï¼‰
   llm:
     provider: "gemini"  # gemini, deepseek, openai, custom
     api_key: "your-api-key-here"
     parameters:
       temperature: 0.7
       max_tokens: 1000
   
   # æˆ–è€…æœ¬åœ° LLM é…ç½® ğŸ†•
   # âš ï¸ é‡è¦æé†’ï¼šæœ¬åœ°æ¨¡å‹å¯èƒ½ç”Ÿæˆä¸è§„èŒƒçš„JSONæ ¼å¼ï¼Œå¯¼è‡´éƒ¨åˆ†äº‹ä»¶æ— æ³•æ­£ç¡®åˆ†æå’Œæé†’
   # å»ºè®®ï¼šç”Ÿäº§ç¯å¢ƒä¼˜å…ˆä½¿ç”¨äº‘ç«¯LLMï¼ˆGemini/DeepSeekç­‰ï¼‰ä»¥ç¡®ä¿ç¨³å®šæ€§
   # llm:
   #   provider: "local"
   #   local:
   #     enabled: true
   #     model_path: "./models/qwen2.5-1.5b-instruct-q4_k_m.gguf"
   #     n_ctx: 4096
   #     n_threads: 4
   #   parameters:
   #     temperature: 0.3  # é™ä½æ¸©åº¦æé«˜è¾“å‡ºç¨³å®šæ€§
   #     max_tokens: 500   # é™åˆ¶è¾“å‡ºé•¿åº¦å‡å°‘æ ¼å¼é”™è¯¯
   #     top_p: 0.8        # å‡å°‘éšæœºæ€§
   
   # CalDAV é…ç½®
   # å•ä¸ªä¾›åº”å•†ï¼ˆå‘åå…¼å®¹ï¼‰
   caldav:
     url: "https://caldav.icloud.com"
     username: "your-icloud@example.com"
     password: "your-app-specific-password"
   
   # æˆ–è€…å¤šä¾›åº”å•†é…ç½® ğŸ†•
   # caldav:
   #   providers:
   #     icloud:
   #       url: "https://caldav.icloud.com"
   #       username: "your-icloud@icloud.com"
   #       password: "your-icloud-app-password"
   #     google:
   #       url: "https://apidata.googleusercontent.com/caldav/v2/your-email@gmail.com/events"
   #       username: "your-email@gmail.com"
   #       password: "your-google-app-password"
   
   # æ•°æ®åº“é…ç½®
   database: "./data/agent.db"
   
   # Webhook é€šçŸ¥é…ç½®
   webhook_url: "https://your.webhook.endpoint"
   webhook_type: "gotify"  # gotify, slack, generic, or custom
   
   # å¿ƒè·³åŒ…é…ç½®ï¼ˆå¯é€‰ï¼‰
   heartbeat:
     enabled: true
     url: "https://uptime-kuma.example.com/api/push/xxxxx"
     interval: 60
   
   # APIæœåŠ¡é…ç½®ï¼ˆå¯é€‰ï¼‰
   api:
     enabled: true
     host: "0.0.0.0"
     port: 8000
   ```

4. **è¿è¡Œç¨‹åº**
   ```bash
   python agent.py
   ```
   
   å¯åŠ¨æ—¶ä¼šæ˜¾ç¤ºåŠŸèƒ½çŠ¶æ€ï¼š
   ```
   ğŸ”§ åŠŸèƒ½çŠ¶æ€:
   ğŸ’— å¿ƒè·³åŒ…: å·²å¯ç”¨ (é—´éš”: 60ç§’)
   ğŸŒ APIæœåŠ¡: å·²å¯ç”¨
      åœ°å€: http://0.0.0.0:8000
      æ–‡æ¡£: http://0.0.0.0:8000/docs
   ```

5. **éªŒè¯å®‰è£…**
   ```bash
   # è¿è¡Œå®Œæ•´æ€§æ£€æŸ¥
   python check.py
   ```
   
   è¿™å°†æ£€æŸ¥ï¼š
   - âœ… æ‰€æœ‰å¿…è¦æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - âœ… Python ä¾èµ–æ˜¯å¦å·²å®‰è£…
   - âœ… é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
   - âœ… Webhook æ¨é€åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼ˆæ”¯æŒ Gotifyã€Slackã€é€šç”¨ã€è‡ªå®šä¹‰æ ¼å¼ï¼‰
   - âœ… å¿ƒè·³åŒ…åŠŸèƒ½æ˜¯å¦å¯ç”¨
   - âœ… API åŠŸèƒ½æ˜¯å¦æ­£å¸¸

### ğŸ  æœ¬åœ° LLM å¿«é€Ÿå…¥é—¨ ğŸ†•

**âš ï¸ é‡è¦æé†’**: æœ¬åœ°æ¨¡å‹ä¸ºå®éªŒæ€§åŠŸèƒ½ï¼Œå»ºè®®ä»…ç”¨äºæµ‹è¯•ç¯å¢ƒã€‚

**å·²çŸ¥é™åˆ¶**ï¼š
- ğŸ“‰ çº¦ 30-50% æ¦‚ç‡ç”Ÿæˆé”™è¯¯ JSON æ ¼å¼
- âš ï¸ å¯èƒ½å¯¼è‡´äº‹ä»¶åˆ†æå¤±è´¥å’Œæé†’ç¼ºå¤±
- ğŸ¯ ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨äº‘ç«¯ LLMï¼ˆGemini/DeepSeekï¼‰

å¦‚æœæ‚¨ä»å¸Œæœ›ä½¿ç”¨æœ¬åœ°æ¨¡å‹å®ç°å®Œå…¨ç¦»çº¿è¿è¡Œï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤å¿«é€Ÿé…ç½®ï¼š

1. **è‡ªåŠ¨ä¸‹è½½å’Œé…ç½®æœ¬åœ°æ¨¡å‹ï¼ˆæ¨èï¼‰**
   ```bash
   # è¿è¡Œè‡ªåŠ¨é…ç½®è„šæœ¬
   python download_model.py
   ```
   
   è¿™å°†è‡ªåŠ¨ï¼š
   - ğŸ“¦ ä¸‹è½½æ¨èçš„ GGUF æ¨¡å‹ï¼ˆçº¦ 1GBï¼‰
   - âš™ï¸ ç”Ÿæˆæœ¬åœ° LLM é…ç½®æ–‡ä»¶
   - ğŸ§ª æµ‹è¯•æ¨¡å‹åŠ è½½å’Œæ¨ç†
   - ğŸ“Š æ˜¾ç¤ºæ€§èƒ½åŸºå‡†

2. **åº”ç”¨æœ¬åœ°é…ç½®**
   ```bash
   # å¤åˆ¶ç”Ÿæˆçš„æœ¬åœ°é…ç½®
   cp config_local_llm.yaml config.yaml
   
   # æˆ–è€…æ‰‹åŠ¨ç¼–è¾‘ç°æœ‰é…ç½®æ–‡ä»¶
   nano config.yaml
   ```

3. **éªŒè¯æœ¬åœ°æ¨¡å‹**
   ```bash
   # æ£€æŸ¥æœ¬åœ° LLM é…ç½®
   python check.py
   ```

4. **å¯åŠ¨ç¨‹åº**
   ```bash
   python agent.py
   ```

**æœ¬åœ° LLM ä¼˜åŠ¿ï¼š**
- ğŸ”’ **å®Œå…¨ç¦»çº¿**ï¼šæ— éœ€ç½‘ç»œè¿æ¥æˆ– API è°ƒç”¨
- ğŸ’° **æ— é¢å¤–æˆæœ¬**ï¼šé¿å… API è°ƒç”¨è´¹ç”¨
- ğŸš€ **å“åº”å¿«é€Ÿ**ï¼šæœ¬åœ°æ¨ç†ï¼Œæ— ç½‘ç»œå»¶è¿Ÿ
- ğŸ›¡ï¸ **éšç§ä¿æŠ¤**ï¼šæ•°æ®ä¸ç¦»å¼€æœ¬åœ°è®¾å¤‡

**æœ¬åœ° LLM é£é™©ï¼š**
- âš ï¸ **æ ¼å¼é”™è¯¯**ï¼šJSON è§£æå¤±è´¥ç‡è¾ƒé«˜
- ğŸ“‰ **å‡†ç¡®æ€§ä¸‹é™**ï¼šäº‹ä»¶åˆ†æè´¨é‡å¯èƒ½ä¸å¦‚äº‘ç«¯æ¨¡å‹
- ğŸ”§ **ç»´æŠ¤æˆæœ¬**ï¼šéœ€è¦æ›´å¤šæ‰‹åŠ¨è°ƒä¼˜å’Œç›‘æ§

**æ¨èé…ç½®ï¼š**
- **è½»é‡ç”¨æˆ·**: Qwen2.5-1.5B (1GB, 2-3GB å†…å­˜)
- **å¹³è¡¡ç”¨æˆ·**: Qwen2.5-3B (2GB, 4-5GB å†…å­˜)  
- **æ€§èƒ½ç”¨æˆ·**: Qwen2.5-7B (4GB, 6-8GB å†…å­˜)

### Docker éƒ¨ç½²

1. **ä½¿ç”¨ docker-composeï¼ˆæ¨èï¼‰**
   ```bash
   # ç¼–è¾‘é…ç½®æ–‡ä»¶
   nano config.yaml
   
   # å¯åŠ¨æœåŠ¡
   docker-compose up -d
   
   # æŸ¥çœ‹æ—¥å¿—
   docker-compose logs -f
   ```

2. **ä½¿ç”¨ Docker ç›´æ¥è¿è¡Œ**
   ```bash
   # æ„å»ºé•œåƒ
   docker build -t Chrona .
   
   # è¿è¡Œå®¹å™¨
   docker run -d \
     --name chrona \
     -v $(pwd)/data:/app/data \
     -v $(pwd)/config.yaml:/app/config.yaml:ro \
     Chrona
   ```

## ğŸš€ æ–°åŠŸèƒ½å¿«é€Ÿå…¥é—¨

### ğŸ’— å¿ƒè·³åŒ…åŠŸèƒ½å¿«é€Ÿé…ç½®

#### Uptime Kuma é…ç½®
1. **åœ¨ Uptime Kuma ä¸­åˆ›å»º Push ç›‘æ§**
   - ç™»å½•æ‚¨çš„ Uptime Kuma é¢æ¿
   - ç‚¹å‡» "Add New Monitor"
   - é€‰æ‹© "Push" ç±»å‹
   - å¡«å†™ç›‘æ§åç§°ï¼š`Chrona`
   - å¤åˆ¶ç”Ÿæˆçš„æ¨é€ URL

2. **é…ç½® config.yaml**
   ```yaml
   heartbeat:
     enabled: true
     url: "https://your-uptime-kuma.com/api/push/AbCdEf123?status=up&msg=OK&ping="
     interval: 60  # æ¯60ç§’å‘é€ä¸€æ¬¡
     timeout: 10
     params:
       status: "up"
       msg: "Schedule Manager is running"
       ping: ""
   ```

#### Healthchecks.io é…ç½®
1. **åœ¨ Healthchecks.io åˆ›å»ºæ£€æŸ¥**
   - ç™»å½• [Healthchecks.io](https://healthchecks.io/)
   - åˆ›å»ºæ–°çš„æ£€æŸ¥é¡¹ç›®
   - å¤åˆ¶ Ping URL

2. **é…ç½® config.yaml**
   ```yaml
   heartbeat:
     enabled: true
     url: "https://hc-ping.com/your-uuid-here"
     interval: 60
     timeout: 10
   ```

### ğŸŒ API åŠŸèƒ½å¿«é€Ÿé…ç½®

#### å¯ç”¨ API æœåŠ¡
åœ¨ `config.yaml` ä¸­æ·»åŠ ï¼š
```yaml
api:
  enabled: true
  host: "0.0.0.0"  # å…è®¸å¤–éƒ¨è®¿é—®ï¼Œä»…æœ¬åœ°ä½¿ç”¨å¯è®¾ä¸º "127.0.0.1"
  port: 8000
```

#### è®¿é—® API æ–‡æ¡£
å¯åŠ¨ç¨‹åºåï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

#### å¸¸ç”¨ API æ¥å£æµ‹è¯•
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# è·å–ç»Ÿè®¡ä¿¡æ¯
curl http://localhost:8000/stats

# è·å–å³å°†åˆ°æ¥çš„äº‹ä»¶
curl http://localhost:8000/events/upcoming

# æŸ¥çœ‹å¿ƒè·³åŒ…çŠ¶æ€
curl http://localhost:8000/heartbeat/status

# æ‰‹åŠ¨å‘é€å¿ƒè·³åŒ…
curl -X POST http://localhost:8000/heartbeat/send

# æ‰‹åŠ¨è§¦å‘äº‹ä»¶è·å–
curl -X POST http://localhost:8000/agent/fetch
```

### ğŸ§ª åŠŸèƒ½æµ‹è¯•

#### å®Œæ•´æ£€æŸ¥å’Œæµ‹è¯•
```bash
python check.py
```
è¿è¡Œé¡¹ç›®å®Œæ•´æ€§æ£€æŸ¥ï¼ŒåŒ…æ‹¬ï¼š
- æ–‡ä»¶ç»“æ„æ£€æŸ¥
- ä¾èµ–éªŒè¯  
- é…ç½®éªŒè¯
- Webhookæ¨é€éªŒè¯
- å¿ƒè·³åŒ…åŠŸèƒ½æµ‹è¯•
- APIåŠŸèƒ½æµ‹è¯•

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºæœ¬é…ç½®

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `llm.provider` | LLM æä¾›å•† | `gemini`ã€`deepseek`ã€`openai`ã€`custom` |
| `llm.api_key` | API å¯†é’¥ | `your-api-key` |
| `llm.parameters.temperature` | åˆ›é€ æ€§å‚æ•° | `0.7` |
| `llm.parameters.max_tokens` | æœ€å¤§ä»¤ç‰Œæ•° | `1000` |
| `database` | æ•°æ®åº“è·¯å¾„ | `./data/agent.db` |
| `webhook_url` | é€šçŸ¥ Webhook åœ°å€ | `https://api.example.com/webhook` |
| `webhook_type` | Webhook ç±»å‹ | `gotify`ã€`slack`ã€`generic` æˆ– `custom` |

**å‘åå…¼å®¹ï¼š** ä»æ”¯æŒæ—§æ ¼å¼ `model` å’Œ `api_key`ï¼Œä½†å»ºè®®ä½¿ç”¨æ–°çš„ `llm` é…ç½®å—ã€‚

### å¿ƒè·³åŒ…é…ç½®

é€šè¿‡å¿ƒè·³åŒ…åŠŸèƒ½ï¼Œç¨‹åºå¯ä»¥å®šæœŸå‘ç›‘æ§æœåŠ¡å‘é€çŠ¶æ€æ›´æ–°ï¼Œç¡®ä¿ç›‘æ§ç³»ç»Ÿèƒ½åŠæ—¶å‘ç°ç¨‹åºå¼‚å¸¸ã€‚

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `heartbeat.enabled` | æ˜¯å¦å¯ç”¨å¿ƒè·³åŒ… | `true` æˆ– `false` |
| `heartbeat.url` | å¿ƒè·³åŒ…æ¨é€URL | Uptime Kuma: `https://uptime.example.com/api/push/xxxxx` |
| `heartbeat.interval` | å‘é€é—´éš”ï¼ˆç§’ï¼‰ | `60` |
| `heartbeat.timeout` | è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ | `10` |
| `heartbeat.params.status` | çŠ¶æ€å‚æ•° | `up`ã€`down` æˆ– `ping` |
| `heartbeat.params.msg` | æ¶ˆæ¯å†…å®¹ | `Schedule Manager is running` |
| `heartbeat.params.ping` | pingå€¼ï¼ˆå¯é€‰ï¼‰ | `10` |

**æ”¯æŒçš„ç›‘æ§æœåŠ¡ï¼š**
- **Uptime Kuma**: `https://uptime-kuma.example.com/api/push/AbCdEf123?status=up&msg=OK&ping=`
- **Healthchecks.io**: `https://hc-ping.com/your-uuid`
- **StatusCake**: `https://push.statuscake.com/?PK=your-key&TestID=your-test-id`
- **è‡ªå®šä¹‰HTTPç«¯ç‚¹**: ä»»ä½•æ¥å—GETè¯·æ±‚çš„HTTPæœåŠ¡

### APIæœåŠ¡é…ç½®

å¯ç”¨APIæœåŠ¡åï¼Œå¯ä»¥é€šè¿‡HTTPæ¥å£è¿œç¨‹ç›‘æ§å’Œæ§åˆ¶ç¨‹åºã€‚

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `api.enabled` | æ˜¯å¦å¯ç”¨APIæœåŠ¡ | `true` æˆ– `false` |
| `api.host` | ç›‘å¬åœ°å€ | `0.0.0.0`ï¼ˆæ‰€æœ‰æ¥å£ï¼‰æˆ– `127.0.0.1`ï¼ˆä»…æœ¬åœ°ï¼‰ |
| `api.port` | ç›‘å¬ç«¯å£ | `8000` |

**APIæ¥å£åˆ—è¡¨ï¼š**

**åŸºç¡€æ¥å£ï¼š**
- `GET /` - æ ¹è·¯å¾„ï¼Œè¿”å›åŸºæœ¬ä¿¡æ¯
- `GET /health` - å¥åº·æ£€æŸ¥
- `GET /config` - è·å–é…ç½®ä¿¡æ¯ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰

**ç»Ÿè®¡æ¥å£ï¼š**
- `GET /stats` - è·å–ç»Ÿè®¡ä¿¡æ¯å’Œå¿ƒè·³åŒ…çŠ¶æ€

**äº‹ä»¶æ¥å£ï¼š**
- `GET /events/upcoming` - è·å–å³å°†åˆ°æ¥çš„äº‹ä»¶
- `GET /events/recent?limit=10` - è·å–æœ€è¿‘çš„äº‹ä»¶è®°å½•
- `GET /events/reminders` - è·å–éœ€è¦æé†’çš„äº‹ä»¶

**å¿ƒè·³åŒ…æ¥å£ï¼š**
- `GET /heartbeat/status` - è·å–å¿ƒè·³åŒ…å‘é€çŠ¶æ€
- `POST /heartbeat/send` - æ‰‹åŠ¨å‘é€å¿ƒè·³åŒ…

**ä»£ç†æ“ä½œæ¥å£ï¼š**
- `POST /agent/fetch` - æ‰‹åŠ¨è§¦å‘äº‹ä»¶è·å–å’Œåˆ†æ
- `POST /agent/check-reminders` - æ‰‹åŠ¨è§¦å‘æé†’æ£€æŸ¥

**APIæ–‡æ¡£ï¼š**
- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`

### CalDAV é…ç½®

Chrona æ”¯æŒå•ä¸ªæˆ–å¤šä¸ª CalDAV æä¾›å•†ï¼Œè®©æ‚¨å¯ä»¥ä»ä¸åŒçš„æ—¥å†æœåŠ¡è·å–æ—¥ç¨‹ã€‚

#### å•ä¸ªæä¾›å•†é…ç½®ï¼ˆå‘åå…¼å®¹ï¼‰

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `caldav.url` | CalDAV æœåŠ¡å™¨åœ°å€ | `https://caldav.icloud.com` |
| `caldav.username` | ç”¨æˆ·å/é‚®ç®± | `user@example.com` |
| `caldav.password` | å¯†ç ï¼ˆå»ºè®®ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼‰ | `app-specific-password` |

```yaml
caldav:
  url: "https://caldav.icloud.com"
  username: "your-email@icloud.com"
  password: "your-app-specific-password"
```

#### å¤šæä¾›å•†é…ç½® ğŸ†•

**æ–¹å¼ä¸€ï¼šå‘½åæä¾›å•†æ ¼å¼ï¼ˆæ¨èï¼‰**
```yaml
caldav:
  providers:
    icloud:
      url: "https://caldav.icloud.com"
      username: "your-icloud@icloud.com"
      password: "your-icloud-app-password"
    
    google:
      url: "https://apidata.googleusercontent.com/caldav/v2/your-email@gmail.com/events"
      username: "your-email@gmail.com"
      password: "your-google-app-password"
    
    outlook:
      url: "https://outlook.live.com/owa/"
      username: "your-email@outlook.com"
      password: "your-outlook-password"
```

**æ–¹å¼äºŒï¼šåˆ—è¡¨æ ¼å¼**
```yaml
caldav:
  - name: "iCloud"
    url: "https://caldav.icloud.com"
    username: "your-icloud@icloud.com"
    password: "your-icloud-app-password"
  
  - name: "Google Calendar"
    url: "https://apidata.googleusercontent.com/caldav/v2/your-email@gmail.com/events"
    username: "your-email@gmail.com"
    password: "your-google-app-password"
```

**å¤šæä¾›å•†ç‰¹æ€§ï¼š**
- ğŸ”„ **å¹¶å‘è·å–**: åŒæ—¶ä»å¤šä¸ªæœåŠ¡è·å–äº‹ä»¶ï¼Œæé«˜æ•ˆç‡
- ğŸ·ï¸ **æ¥æºæ ‡è¯†**: è‡ªåŠ¨æ ‡è®°äº‹ä»¶æ¥æºï¼Œå¦‚ "å·¥ä½œæ—¥å† (iCloud)"
- âš¡ **å®¹é”™å¤„ç†**: å•ä¸ªæœåŠ¡æ•…éšœä¸å½±å“å…¶ä»–æœåŠ¡
- ğŸ“Š **ç»Ÿä¸€ç®¡ç†**: æ‰€æœ‰æ—¥å†äº‹ä»¶åœ¨ä¸€ä¸ªç•Œé¢ä¸­ç»Ÿä¸€æ˜¾ç¤º

### æ”¯æŒçš„ CalDAV æœåŠ¡

#### ä¸»æµæœåŠ¡é…ç½®

| æœåŠ¡ | URL | è¯´æ˜ |
|------|-----|------|
| **iCloud** | `https://caldav.icloud.com` | Apple çš„æ—¥å†æœåŠ¡ |
| **Google Calendar** | `https://apidata.googleusercontent.com/caldav/v2/` | Google çš„æ—¥å†æœåŠ¡ |
| **Outlook/Exchange** | `https://outlook.live.com/owa/` | Microsoft çš„é‚®ç®±å’Œæ—¥å†æœåŠ¡ |
| **Yahoo** | `https://caldav.calendar.yahoo.com` | Yahoo çš„æ—¥å†æœåŠ¡ |

#### è·å–é…ç½®ä¿¡æ¯

**iCloud:**
1. è®¿é—® [appleid.apple.com](https://appleid.apple.com/)
2. ç™»å½•å¹¶ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç 
3. ä½¿ç”¨è¯¥å¯†ç ä½œä¸º CalDAV å¯†ç 

**Google Calendar:**
1. è®¿é—® [Google Calendar è®¾ç½®](https://calendar.google.com/calendar/u/0/r/settings/export)
2. è·å–æ‚¨çš„æ—¥å† ID
3. ä½¿ç”¨åº”ç”¨å¯†ç è¿›è¡Œèº«ä»½éªŒè¯

**Outlook:**
1. å¯ç”¨ IMAP/CalDAV è®¿é—®
2. ä½¿ç”¨æ‚¨çš„ Outlook è´¦æˆ·å‡­æ®

#### è‡ªå®šä¹‰ CalDAV æœåŠ¡

Chrona æ”¯æŒä»»ä½•æ ‡å‡†çš„ CalDAV æœåŠ¡ï¼š

```yaml
caldav:
  providers:
    custom_server:
      url: "https://your-caldav-server.com"
      username: "your-username"
      password: "your-password"
```

### Webhook é€šçŸ¥é…ç½®

ç³»ç»Ÿæ”¯æŒå¤šç§ Webhook é€šçŸ¥æ ¼å¼ï¼Œé€šè¿‡ `webhook_type` é…ç½®é¡¹é€‰æ‹©ï¼š

#### Gotify é€šçŸ¥

Gotify æ˜¯ä¸€ä¸ªç®€å•çš„è‡ªæ‰˜ç®¡é€šçŸ¥æœåŠ¡å™¨ã€‚

**é…ç½®ç¤ºä¾‹ï¼š**
```yaml
webhook_url: "https://your-gotify-server.com/message?token=YOUR_TOKEN"
webhook_type: "gotify"
```

**ç‰¹æ€§ï¼š**
- æ”¯æŒä¼˜å…ˆçº§è®¾ç½®ï¼ˆé‡è¦äº‹ä»¶ä¼˜å…ˆçº§ä¸º 8ï¼Œæ™®é€šäº‹ä»¶ä¸º 5ï¼‰
- æ”¯æŒ Markdown æ ¼å¼å†…å®¹
- é™„åŠ äº‹ä»¶å…ƒæ•°æ®ä¿¡æ¯

#### Slack é€šçŸ¥

é€šè¿‡ Slack Incoming Webhooks å‘é€é€šçŸ¥ã€‚

**é…ç½®ç¤ºä¾‹ï¼š**
```yaml
webhook_url: "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
webhook_type: "slack"
```

**ç‰¹æ€§ï¼š**
- ä½¿ç”¨ Slack Blocks æ ¼å¼
- æ”¯æŒå¯Œæ–‡æœ¬æ ¼å¼
- ç»“æ„åŒ–ä¿¡æ¯å±•ç¤º

#### è‡ªå®šä¹‰ Webhook ğŸ†•

å®Œå…¨è‡ªå®šä¹‰çš„ Webhook æ ¼å¼ï¼Œé€‚ç”¨äºä»»ä½•ç¬¬ä¸‰æ–¹æœåŠ¡ã€‚

**é…ç½®ç¤ºä¾‹ï¼š**
```yaml
webhook_type: "custom"
webhook_custom:
  enabled: true
  url: "https://your-custom-api.com/notifications"
  method: "POST"  # æ”¯æŒ GET, POST, PUT
  timeout: 30
  headers:
    Authorization: "Bearer your-api-token"
    Content-Type: "application/json"
    X-Custom-Header: "custom-value"
  payload_template: |
    {
      "alert": {
        "title": {{title}},
        "message": {{body}},
        "timestamp": {{timestamp}},
        "priority": {{priority}},
        "event": {
          "summary": {{event.summary}},
          "start_time": {{event.start_time}},
          "calendar": {{event.calendar_name}},
          "duration": {{event.duration_minutes}}
        },
        "analysis": {
          "important": {{analysis.important}},
          "reason": {{analysis.reason}}
        }
      }
    }
```

**ç‰¹æ€§ï¼š**
- **å®Œå…¨è‡ªå®šä¹‰è¯·æ±‚æ ¼å¼**ï¼šæ”¯æŒä»»æ„ JSON ç»“æ„
- **æ¨¡æ¿å˜é‡ç³»ç»Ÿ**ï¼šä½¿ç”¨ `{{variable}}` æ ¼å¼åŠ¨æ€æ’å…¥æ•°æ®
- **å¤šç§ HTTP æ–¹æ³•**ï¼šæ”¯æŒ GETã€POSTã€PUT è¯·æ±‚
- **è‡ªå®šä¹‰è¯·æ±‚å¤´**ï¼šæ”¯æŒè®¤è¯ã€å†…å®¹ç±»å‹ç­‰ä»»æ„è¯·æ±‚å¤´
- **çµæ´»çš„æ•°æ®æ˜ å°„**ï¼šå¯è®¿é—®äº‹ä»¶å’Œ AI åˆ†æçš„æ‰€æœ‰å­—æ®µ

**å¯ç”¨å˜é‡ï¼š**

å®Œæ•´çš„æ¨¡æ¿å˜é‡ç³»ç»Ÿï¼Œæ”¯æŒåµŒå¥—è®¿é—®ï¼š

**åŸºç¡€å˜é‡ï¼š**
- `{{title}}` - é€šçŸ¥æ ‡é¢˜
- `{{body}}` - é€šçŸ¥å†…å®¹
- `{{timestamp}}` - æ—¶é—´æˆ³
- `{{priority}}` - ä¼˜å…ˆçº§ï¼ˆæ•°å­—ï¼‰
- `{{event.summary}}` - äº‹ä»¶æ ‡é¢˜
- `{{event.description}}` - äº‹ä»¶æè¿°
- `{{event.start_time}}` - å¼€å§‹æ—¶é—´
- `{{event.calendar_name}}` - æ—¥å†åç§°
- `{{event.duration_minutes}}` - æŒç»­æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
- `{{analysis.important}}` - æ˜¯å¦é‡è¦ï¼ˆtrue/falseï¼‰
- `{{analysis.need_remind}}` - æ˜¯å¦éœ€è¦æé†’
- `{{analysis.reason}}` - AI åˆ†æåŸå› 
- `{{analysis.task}}` - ä»»åŠ¡æè¿°

**äº‹ä»¶è¯¦ç»†ä¿¡æ¯ï¼š**
- `{{event.end_time}}` - ç»“æŸæ—¶é—´
- `{{event.location}}` - äº‹ä»¶åœ°ç‚¹ï¼ˆå¦‚æœæœ‰ï¼‰
- `{{event.organizer}}` - ç»„ç»‡è€…ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
- `{{event.uid}}` - äº‹ä»¶å”¯ä¸€æ ‡è¯†ç¬¦

**ç³»ç»Ÿä¿¡æ¯ï¼š**
- `{{system.hostname}}` - ä¸»æœºå
- `{{system.timestamp_iso}}` - ISO æ ¼å¼æ—¶é—´æˆ³

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```yaml
# Discord Webhook ç¤ºä¾‹
webhook_custom:
  url: "https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN"
  method: "POST"
  headers:
    Content-Type: "application/json"
  payload_template: |
    {
      "embeds": [{
        "title": "ğŸ“… æ—¥ç¨‹æé†’",
        "description": {{event.summary}},
        "color": 3447003,
        "fields": [
          {
            "name": "â° å¼€å§‹æ—¶é—´",
            "value": {{event.start_time}},
            "inline": true
          },
          {
            "name": "ğŸ—‚ï¸ æ—¥å†",
            "value": {{event.calendar_name}},
            "inline": true
          },
          {
            "name": "ğŸ¯ ä»»åŠ¡",
            "value": {{analysis.task}},
            "inline": false
          }
        ],
        "timestamp": {{system.timestamp_iso}}
      }]
    }

# ä¼ä¸šå¾®ä¿¡ç¾¤æœºå™¨äººç¤ºä¾‹
webhook_custom:
  url: "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=YOUR_KEY"
  method: "POST"
  headers:
    Content-Type: "application/json"
  payload_template: |
    {
      "msgtype": "markdown",
      "markdown": {
        "content": "## ğŸ“… æ—¥ç¨‹æé†’\n\n> **äº‹ä»¶**: {{event.summary}}\n> **æ—¶é—´**: {{event.start_time}}\n> **æ—¥å†**: {{event.calendar_name}}\n> **é‡è¦**: {{analysis.important}}\n> **ä»»åŠ¡**: {{analysis.task}}"
      }
    }

# é’‰é’‰ç¾¤æœºå™¨äººç¤ºä¾‹
webhook_custom:
  url: "https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN"
  method: "POST"
  headers:
    Content-Type: "application/json"
  payload_template: |
    {
      "msgtype": "actionCard",
      "actionCard": {
        "title": "ğŸ“… {{event.summary}}",
        "text": "### æ—¥ç¨‹æé†’\n\n**äº‹ä»¶**: {{event.summary}}\n\n**æ—¶é—´**: {{event.start_time}}\n\n**æ—¥å†**: {{event.calendar_name}}\n\n**é‡è¦ç¨‹åº¦**: {{analysis.important}}\n\n**å»ºè®®ä»»åŠ¡**: {{analysis.task}}",
        "btnOrientation": "0"
      }
    }
```

#### é€šç”¨ Webhook

é€‚ç”¨äºç®€å•çš„è‡ªå®šä¹‰é€šçŸ¥æœåŠ¡ã€‚

**é…ç½®ç¤ºä¾‹ï¼š**
```yaml
webhook_url: "https://your-custom-webhook.com/notify"
webhook_type: "generic"
```

**ç‰¹æ€§ï¼š**
- JSON æ ¼å¼æ•°æ®
- åŒ…å«å®Œæ•´äº‹ä»¶å’Œåˆ†æä¿¡æ¯
- æ˜“äºé›†æˆå…¶ä»–æœåŠ¡

## ğŸ”§ LLM API é…ç½®

### V3.0 æ–°é…ç½®æ–¹å¼ï¼ˆæ¨èï¼‰

#### Gemini API

1. è®¿é—® [Google AI Studio](https://makersuite.google.com/app/apikey)
2. åˆ›å»º API å¯†é’¥
3. åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š
   ```yaml
   llm:
     provider: "gemini"
     api_key: "your-gemini-api-key"
     parameters:
       temperature: 0.7  # åˆ›é€ æ€§å‚æ•°
       max_tokens: 1000  # æœ€å¤§ä»¤ç‰Œæ•°
       top_p: 0.9       # æ ¸é‡‡æ ·å‚æ•°
   ```

#### DeepSeek API

1. è®¿é—® [DeepSeek æ§åˆ¶å°](https://platform.deepseek.com/api_keys)
2. åˆ›å»º API å¯†é’¥
3. åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š
   ```yaml
   llm:
     provider: "deepseek"
     api_key: "your-deepseek-api-key"
     parameters:
       temperature: 0.7
       max_tokens: 1000
   ```

#### OpenAI API

1. è®¿é—® [OpenAI æ§åˆ¶å°](https://platform.openai.com/api-keys)
2. åˆ›å»º API å¯†é’¥
3. åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š
   ```yaml
   llm:
     provider: "openai"
     api_key: "your-openai-api-key"
     parameters:
       temperature: 0.7
       max_tokens: 1000
       top_p: 0.9
   ```

#### è‡ªå®šä¹‰ API

æ”¯æŒä»»ä½•å…¼å®¹ OpenAI æ ¼å¼çš„ APIï¼š
```yaml
llm:
  provider: "custom"
  custom:
    enabled: true
    url: "https://your-api-endpoint.com/v1/chat/completions"
    model: "your-model-name"
    headers:
      Authorization: "Bearer your-api-key"
    payload_format: "openai"
    response_format: "openai"
    timeout: 30
  parameters:
    temperature: 0.7
    max_tokens: 1000
```

#### æœ¬åœ° LLM æ¨¡å‹ï¼ˆGGUFï¼‰ğŸ†•

Chrona ç°åœ¨æ”¯æŒæœ¬åœ° GGUF æ ¼å¼çš„ LLM æ¨¡å‹ï¼Œå¯å®Œå…¨ç¦»çº¿è¿è¡Œï¼Œä¿æŠ¤éšç§å¹¶é™ä½æˆæœ¬ã€‚

**ğŸ”§ ç¯å¢ƒè¦æ±‚ï¼š**
- æ”¯æŒ GGUF æ ¼å¼çš„æœ¬åœ°æ¨¡å‹æ–‡ä»¶
- `llama-cpp-python` åº“ï¼ˆä¼šè‡ªåŠ¨å®‰è£…ï¼‰
- è¶³å¤Ÿçš„ç³»ç»Ÿå†…å­˜ï¼ˆå»ºè®® 8GB+ï¼‰

**ğŸ“¦ å®‰è£…å’Œé…ç½®ï¼š**

1. **è‡ªåŠ¨ä¸‹è½½æ¨èæ¨¡å‹ï¼ˆæ¨èï¼‰**
   ```bash
   # è¿è¡Œè‡ªåŠ¨ä¸‹è½½è„šæœ¬
   python download_model.py
   ```
   
   è¿™å°†è‡ªåŠ¨ï¼š
   - ä¸‹è½½æ¨èçš„ GGUF æ¨¡å‹åˆ° `models/` ç›®å½•
   - ç”Ÿæˆæœ¬åœ° LLM é…ç½®ç¤ºä¾‹
   - æµ‹è¯•æ¨¡å‹åŠ è½½å’Œæ¨ç†
   - æ˜¾ç¤ºæ€§èƒ½åŸºå‡†

2. **æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹**
   
   åˆ›å»º `models/` ç›®å½•å¹¶ä¸‹è½½ GGUF æ¨¡å‹ï¼š
   ```bash
   mkdir models
   # ä¸‹è½½ç¤ºä¾‹ï¼ˆä½¿ç”¨ HuggingFace Hubï¼‰
   pip install huggingface-hub
   python -c "
   from huggingface_hub import hf_hub_download
   hf_hub_download(
       repo_id='Qwen/Qwen2.5-1.5B-Instruct-GGUF',
       filename='qwen2.5-1.5b-instruct-q4_k_m.gguf',
       local_dir='./models'
   )"
   ```

3. **é…ç½®æœ¬åœ° LLM**
   ```yaml
   llm:
     provider: "local"
     local:
       enabled: true
       model_path: "./models/qwen2.5-1.5b-instruct-q4_k_m.gguf"
       # æ¨¡å‹å‚æ•°
       n_ctx: 4096          # ä¸Šä¸‹æ–‡é•¿åº¦
       n_threads: 4         # CPU çº¿ç¨‹æ•°
       n_gpu_layers: 0      # GPU å±‚æ•°ï¼ˆ0=ä»…CPUï¼‰
       verbose: false       # æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—
     parameters:
       temperature: 0.7     # åˆ›é€ æ€§
       max_tokens: 1000     # æœ€å¤§è¾“å‡ºé•¿åº¦
       top_p: 0.9          # æ ¸é‡‡æ ·
       repeat_penalty: 1.1  # é‡å¤æƒ©ç½š
   ```

**ğŸš€ æ¨èæ¨¡å‹ï¼š**

| æ¨¡å‹åç§° | å¤§å° | å†…å­˜éœ€æ±‚ | æ€§èƒ½ | æ¨èç”¨é€” |
|----------|------|----------|------|----------|
| Qwen2.5-1.5B-Instruct-Q4_K_M | ~1.0GB | 2-3GB | å¿«é€Ÿ | è½»é‡éƒ¨ç½²ï¼Œå¿«é€Ÿå“åº” |
| Qwen2.5-3B-Instruct-Q4_K_M | ~2.0GB | 4-5GB | ä¸­ç­‰ | å¹³è¡¡æ€§èƒ½å’Œè´¨é‡ |
| Qwen2.5-7B-Instruct-Q4_K_M | ~4.0GB | 6-8GB | é«˜ | é«˜è´¨é‡åˆ†æ |

**âš™ï¸ æ€§èƒ½ä¼˜åŒ–ï¼š**

```yaml
# CPU ä¼˜åŒ–é…ç½®
llm:
  provider: "local"
  local:
    model_path: "./models/your-model.gguf"
    n_ctx: 2048          # å‡å°‘ä¸Šä¸‹æ–‡é•¿åº¦
    n_threads: 8         # ä½¿ç”¨æ›´å¤š CPU çº¿ç¨‹
    n_batch: 512         # æ‰¹å¤„ç†å¤§å°
    use_mlock: true      # é”å®šå†…å­˜

# GPU åŠ é€Ÿé…ç½®ï¼ˆå¦‚æœ‰ CUDA GPUï¼‰
llm:
  provider: "local"
  local:
    model_path: "./models/your-model.gguf"
    n_gpu_layers: 35     # å°†å±‚åŠ è½½åˆ° GPU
    # å…¶ä»–å‚æ•°...
```

**ğŸ” ä¾èµ–æ£€æŸ¥ï¼š**
è¿è¡Œé…ç½®æ£€æŸ¥ä¼šè‡ªåŠ¨æ£€æµ‹æœ¬åœ° LLM ä¾èµ–ï¼š
```bash
python check.py
```

**ğŸ› ï¸ æ•…éšœæ’é™¤ï¼š**

**é—®é¢˜ï¼šæ¨¡å‹åŠ è½½å¤±è´¥**
```bash
# æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨å’Œå®Œæ•´
python -c "
import os
model_path = './models/your-model.gguf'
if os.path.exists(model_path):
    print(f'æ¨¡å‹æ–‡ä»¶å­˜åœ¨ï¼Œå¤§å°: {os.path.getsize(model_path) / 1024**3:.2f} GB')
else:
    print('æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨')
"
```

**é—®é¢˜ï¼šå†…å­˜ä¸è¶³**
- é€‰æ‹©æ›´å°çš„æ¨¡å‹ï¼ˆå¦‚ 1.5B è€Œä¸æ˜¯ 7Bï¼‰
- å‡å°‘ `n_ctx` å‚æ•°
- è®¾ç½® `n_gpu_layers: 0` ä»…ä½¿ç”¨ CPU

**é—®é¢˜ï¼šæ¨ç†é€Ÿåº¦æ…¢**
- å¢åŠ  `n_threads` åˆ° CPU æ ¸å¿ƒæ•°
- ä½¿ç”¨é‡åŒ–ç¨‹åº¦æ›´é«˜çš„æ¨¡å‹ï¼ˆQ4_K_Mï¼‰
- è€ƒè™‘ GPU åŠ é€Ÿï¼ˆå¦‚æœå¯ç”¨ï¼‰

**ğŸ“š æ›´å¤šä¿¡æ¯ï¼š**
- è¯¦ç»†æ¨¡å‹è¯´æ˜ï¼šæŸ¥çœ‹ `models/README.md`
- å®Œæ•´é…ç½®ç¤ºä¾‹ï¼šæŸ¥çœ‹ `config_local_llm.yaml`
- æ¨¡å‹ä¸‹è½½å·¥å…·ï¼šä½¿ç”¨ `download_model.py`

### å‘åå…¼å®¹é…ç½®

#### ä¼ ç»Ÿ Gemini é…ç½®
```yaml
model: gemini
api_key: "your-gemini-api-key"
```

#### ä¼ ç»Ÿ DeepSeek é…ç½®
```yaml
model: deepseek
api_key: "your-deepseek-api-key"
```

## ğŸ“± Gotify é€šçŸ¥æœåŠ¡é…ç½®

### ä»€ä¹ˆæ˜¯ Gotifyï¼Ÿ

Gotify æ˜¯ä¸€ä¸ªç®€å•çš„è‡ªæ‰˜ç®¡æ¨é€é€šçŸ¥æœåŠ¡å™¨ï¼Œç‰¹åˆ«é€‚åˆä¸ªäººæˆ–å°å›¢é˜Ÿä½¿ç”¨ã€‚å®ƒæä¾›äº†ï¼š
- ğŸ“± ç§»åŠ¨åº”ç”¨ï¼ˆAndroidï¼‰
- ğŸŒ Web ç•Œé¢
- ğŸ”§ ç®€å•çš„ REST API
- ğŸ”’ å®Œå…¨è‡ªæ‰˜ç®¡ï¼Œæ•°æ®éšç§å¯æ§

### å¿«é€Ÿéƒ¨ç½² Gotify

#### ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p /opt/gotify/data

# è¿è¡Œ Gotify å®¹å™¨
docker run -d \
  --name gotify \
  -p 8080:80 \
  -v /opt/gotify/data:/app/data \
  --restart unless-stopped \
  gotify/server:latest
```

#### ä½¿ç”¨ Docker Compose

åˆ›å»º `docker-compose.yml` æ–‡ä»¶ï¼š
```yaml
version: '3.8'
services:
  gotify:
    image: gotify/server:latest
    container_name: gotify
    ports:
      - "8080:80"
    volumes:
      - ./gotify_data:/app/data
    restart: unless-stopped
    environment:
      - GOTIFY_DEFAULTUSER_NAME=admin
      - GOTIFY_DEFAULTUSER_PASS=your_password_here
```

è¿è¡Œï¼š
```bash
docker-compose up -d
```

### é…ç½® Gotify

1. **è®¿é—® Gotify Web ç•Œé¢**
   - æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://your-server:8080`
   - ä½¿ç”¨é»˜è®¤è´¦æˆ·ç™»å½•ï¼ˆadmin/adminï¼‰

2. **åˆ›å»ºåº”ç”¨ç¨‹åº**
   - åœ¨ "Apps" é¡µé¢ç‚¹å‡» "Create App"
   - è¾“å…¥åº”ç”¨åç§°ï¼š`Chrona`
   - ä¿å­˜å¹¶å¤åˆ¶ç”Ÿæˆçš„ Token

3. **é…ç½® Chrona**
   ```yaml
   webhook_url: "http://your-gotify-server:8080/message?token=YOUR_TOKEN"
   webhook_type: "gotify"
   ```

4. **å®‰è£…ç§»åŠ¨åº”ç”¨**
   - ä¸‹è½½ [Gotify Android åº”ç”¨](https://github.com/gotify/android/releases)
   - æ·»åŠ æœåŠ¡å™¨ï¼š`http://your-gotify-server:8080`
   - ä½¿ç”¨æ‚¨çš„è´¦æˆ·ç™»å½•

### Gotify ä¼˜å…ˆçº§è¯´æ˜

Chrona ä¼šæ ¹æ®äº‹ä»¶é‡è¦æ€§è‡ªåŠ¨è®¾ç½®é€šçŸ¥ä¼˜å…ˆçº§ï¼š

| ä¼˜å…ˆçº§ | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|--------|------|----------|
| 8 | é«˜ä¼˜å…ˆçº§ | é‡è¦äº‹ä»¶ï¼ˆ`important: true`ï¼‰ |
| 5 | æ™®é€šä¼˜å…ˆçº§ | ä¸€èˆ¬äº‹ä»¶ |

### å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç **ï¼šé¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹é»˜è®¤çš„ admin å¯†ç 
2. **ä½¿ç”¨ HTTPS**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­é…ç½® SSL/TLS
3. **é˜²ç«å¢™è§„åˆ™**ï¼šé™åˆ¶ Gotify æœåŠ¡å™¨çš„è®¿é—®
4. **å®šæœŸå¤‡ä»½**ï¼šå¤‡ä»½ Gotify æ•°æ®ç›®å½•

## ğŸ“Š ä½¿ç”¨åœºæ™¯

### å·¥ä½œåœºæ™¯
- ä¼šè®®æé†’
- æˆªæ­¢æ—¥æœŸæé†’
- é‡è¦çº¦ä¼šæé†’

### ä¸ªäººåœºæ™¯
- ç”Ÿæ—¥æé†’
- çº¦ä¼šæé†’
- æ´»åŠ¨æé†’

### ç›‘æ§åœºæ™¯ ğŸ†•
- **Uptime Kuma é›†æˆ**: å®æ—¶ç›‘æ§ç¨‹åºè¿è¡ŒçŠ¶æ€
- **API ç›‘æ§**: é€šè¿‡æ¥å£æŸ¥çœ‹ç¨‹åºå¥åº·çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯
- **è¿œç¨‹ç®¡ç†**: é€šè¿‡ API è¿œç¨‹è§¦å‘äº‹ä»¶è·å–å’Œæé†’æ£€æŸ¥
- **çŠ¶æ€çœ‹æ¿**: å®æ—¶æŸ¥çœ‹å¿ƒè·³åŒ…å‘é€çŠ¶æ€å’Œé”™è¯¯ç»Ÿè®¡

### API ä½¿ç”¨ç¤ºä¾‹ ğŸ†•

```bash
# æ£€æŸ¥ç¨‹åºå¥åº·çŠ¶æ€
curl http://localhost:8000/health

# è·å–ç»Ÿè®¡ä¿¡æ¯
curl http://localhost:8000/stats

# æŸ¥çœ‹å³å°†åˆ°æ¥çš„äº‹ä»¶
curl http://localhost:8000/events/upcoming

# æ‰‹åŠ¨è§¦å‘äº‹ä»¶è·å–
curl -X POST http://localhost:8000/agent/fetch

# æŸ¥çœ‹å¿ƒè·³åŒ…çŠ¶æ€
curl http://localhost:8000/heartbeat/status

# æ‰‹åŠ¨å‘é€å¿ƒè·³åŒ…
curl -X POST http://localhost:8000/heartbeat/send
```

## ğŸ”” é€šçŸ¥æ ¼å¼

### Gotify æ ¼å¼
```json
{
  "title": "ğŸ“… æ—¥ç¨‹æé†’: é¡¹ç›®è¯„å®¡ä¼šè®®",
  "message": "â° å¼€å§‹æ—¶é—´: 2025-06-19 14:00:00\nâ° ç»“æŸæ—¶é—´: 2025-06-19 15:30:00\nâ±ï¸ æŒç»­æ—¶é—´: 1å°æ—¶30åˆ†é’Ÿ\nğŸ—‚ï¸ æ—¥å†: å·¥ä½œæ—¥å†\nğŸ“ æè¿°: è®¨è®ºQ2é¡¹ç›®è¿›å±•å’Œä¸‹é˜¶æ®µè®¡åˆ’\nğŸ¯ ä»»åŠ¡: å‚åŠ é¡¹ç›®è¯„å®¡ä¼šè®®\nâ­ é‡è¦ç¨‹åº¦: é«˜\nâ±ï¸ å»ºè®®æå‰: 15åˆ†é’Ÿ\nğŸ’­ åˆ†æ: åŸºäºå·¥ä½œæ—¥å†åˆ¤æ–­ï¼Œè¿™æ˜¯é‡è¦çš„å·¥ä½œä¼šè®®",
  "priority": 8,
  "extras": {
    "client::display": {
      "contentType": "text/markdown"
    },
    "event": {
      "summary": "é¡¹ç›®è¯„å®¡ä¼šè®®",
      "description": "è®¨è®ºQ2é¡¹ç›®è¿›å±•å’Œä¸‹é˜¶æ®µè®¡åˆ’",
      "start_time": "2025-06-19 14:00:00",
      "calendar_name": "å·¥ä½œæ—¥å†"
    },
    "analysis": {
      "task": "å‚åŠ é¡¹ç›®è¯„å®¡ä¼šè®®",
      "important": true,
      "need_remind": true,
      "minutes_before_remind": 15,
      "reason": "åŸºäºå·¥ä½œæ—¥å†åˆ¤æ–­ï¼Œè¿™æ˜¯é‡è¦çš„å·¥ä½œä¼šè®®"
    }
  }
}
```

### Slack æ ¼å¼
```json
{
  "text": "ğŸ“… æ—¥ç¨‹æé†’: ä¼šè®®æ ‡é¢˜",
  "blocks": [
    {
      "type": "section",
      "text": {
        "type": "mrkdwn",
        "text": "*ğŸ“… ä¼šè®®æ ‡é¢˜*"
      }
    },
    {
      "type": "section",
      "fields": [
        {
          "type": "mrkdwn",
          "text": "*â° æ—¶é—´:*\n2024-01-01 14:00:00"
        },
        {
          "type": "mrkdwn",
          "text": "*â±ï¸ å»ºè®®æå‰:*\n15åˆ†é’Ÿ"
        }
      ]
    }
  ]
}
```

### é€šç”¨ Webhook æ ¼å¼
```json
{
  "title": "ğŸ“… æ—¥ç¨‹æé†’: ä¼šè®®æ ‡é¢˜",
  "body": "â° æ—¶é—´: 2024-01-01 14:00:00\nğŸ“ æè¿°: ä¼šè®®æè¿°\nâ±ï¸ å»ºè®®æå‰: 15åˆ†é’Ÿ",
  "timestamp": "2024-01-01T13:45:00",
  "event": {
    "summary": "ä¼šè®®æ ‡é¢˜",
    "description": "ä¼šè®®æè¿°",
    "start_time": "2024-01-01 14:00:00"
  },
  "analysis": {
    "task": "å‚åŠ å›¢é˜Ÿä¼šè®®",
    "important": true,
    "need_remind": true,
    "minutes_before_remind": 15,
    "reason": "é‡è¦çš„å›¢é˜Ÿä¼šè®®éœ€è¦æå‰å‡†å¤‡"
  }
}
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
Chrona/
â”œâ”€â”€ agent.py                 # ä¸»åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ config.py               # é…ç½®åŠ è½½å™¨
â”œâ”€â”€ config.yaml.example     # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ check.py                # é¡¹ç›®å®Œæ•´æ€§æ£€æŸ¥å·¥å…·
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ Dockerfile             # Dockeré•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml     # Docker Composeé…ç½®
â”œâ”€â”€ start.sh               # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop.sh                # åœæ­¢è„šæœ¬
â”œâ”€â”€ LICENSE                # MITè®¸å¯è¯
â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ .gitignore             # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ ai/                    # AIåˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ LLM_agent.py       # Gemini/DeepSeek APIæ¥å£
â”œâ”€â”€ caldav_client/         # CalDAVå®¢æˆ·ç«¯æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ caldav_client.py   # CalDAVåè®®å®ç°
â”œâ”€â”€ memory/                # æ•°æ®å­˜å‚¨æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ database.py        # SQLiteæ•°æ®åº“æ“ä½œ
â”œâ”€â”€ notifier/              # é€šçŸ¥æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ webhook.py         # Webhooké€šçŸ¥å®ç°
â”œâ”€â”€ heartbeat/             # å¿ƒè·³åŒ…æ¨¡å— ğŸ†•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ heartbeat.py       # å¿ƒè·³åŒ…å‘é€å™¨
â”œâ”€â”€ api/                   # APIæœåŠ¡æ¨¡å— ğŸ†•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ api_server.py      # FastAPIæœåŠ¡å™¨
â””â”€â”€ data/                  # æ•°æ®ç›®å½•(è¿è¡Œæ—¶åˆ›å»º)
    â””â”€â”€ agent.db           # SQLiteæ•°æ®åº“æ–‡ä»¶
```

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### events è¡¨
å­˜å‚¨æ—¥ç¨‹äº‹ä»¶å’Œ AI åˆ†æç»“æœ
- `id`: ä¸»é”®
- `uid`: äº‹ä»¶å”¯ä¸€æ ‡è¯†
- `summary`: äº‹ä»¶æ ‡é¢˜
- `description`: äº‹ä»¶æè¿°
- `start_time`: å¼€å§‹æ—¶é—´
- `end_time`: ç»“æŸæ—¶é—´
- `duration_minutes`: æŒç»­æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
- `calendar_name`: æ—¥å†åç§°
- `result`: AI åˆ†æç»“æœï¼ˆJSONï¼‰
- `reminded`: æ˜¯å¦å·²æé†’
- `created_at`: åˆ›å»ºæ—¶é—´
- `updated_at`: æ›´æ–°æ—¶é—´

### reminders è¡¨
å­˜å‚¨æé†’å‘é€è®°å½•
- `id`: ä¸»é”®
- `event_id`: å…³è”äº‹ä»¶ ID
- `sent_at`: å‘é€æ—¶é—´
- `status`: å‘é€çŠ¶æ€

## ğŸ› ï¸ å¼€å‘å’Œè°ƒè¯•

### æŸ¥çœ‹æ—¥å¿—
```bash
# Docker ç¯å¢ƒ
docker-compose logs -f Chrona

# æœ¬åœ°ç¯å¢ƒ
python agent.py
```

### æµ‹è¯•åŠŸèƒ½ ğŸ†•
```bash
# é¡¹ç›®å®Œæ•´æ€§å’ŒåŠŸèƒ½æ£€æŸ¥
python check.py
```

### æµ‹è¯• Webhook
ç¨‹åºå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨å‘é€æµ‹è¯•é€šçŸ¥ï¼Œç¡®ä¿ Webhook é…ç½®æ­£ç¡®ã€‚

### æµ‹è¯• API æ¥å£ ğŸ†•
```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# æŸ¥çœ‹ API æ–‡æ¡£
# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€: http://localhost:8000/docs
```

### æµ‹è¯•å¿ƒè·³åŒ… ğŸ†•
```bash
# æŸ¥çœ‹å¿ƒè·³åŒ…çŠ¶æ€
curl http://localhost:8000/heartbeat/status

# æ‰‹åŠ¨å‘é€å¿ƒè·³åŒ…
curl -X POST http://localhost:8000/heartbeat/send
```

### æ‰‹åŠ¨è§¦å‘åˆ†æ
```python
from caldav_client.caldav_client import get_upcoming_events
from ai.LLM_agent import analyze_event
from config import CONFIG

events = get_upcoming_events(CONFIG['caldav'])
for event in events:
    result = analyze_event(event['summary'], event['description'], CONFIG)
    print(result)
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¿ƒè·³åŒ…ç›¸å…³é—®é¢˜

1. **å¿ƒè·³åŒ…å‘é€å¤±è´¥**
   ```bash
   # æ£€æŸ¥å¿ƒè·³åŒ…çŠ¶æ€
   curl http://localhost:8000/heartbeat/status
   
   # æŸ¥çœ‹é”™è¯¯æ¬¡æ•°å’Œæœ€åå‘é€æ—¶é—´
   ```

2. **URL é…ç½®é”™è¯¯**
   - æ£€æŸ¥ Uptime Kuma æˆ–ç›‘æ§æœåŠ¡çš„ URL æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
   - éªŒè¯æ¨é€ Token æ˜¯å¦æœ‰æ•ˆ

3. **ç½‘ç»œæƒé™é—®é¢˜**
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
   - ç¡®è®¤ç›‘æ§æœåŠ¡å…è®¸æ¥æ”¶æ¨é€
   - éªŒè¯ SSL è¯ä¹¦æ˜¯å¦æœ‰æ•ˆ

### API ç›¸å…³é—®é¢˜

1. **ç«¯å£å ç”¨**
   ```bash
   # æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
   netstat -an | grep 8000
   
   # æˆ–è€…ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£
   ```

2. **è®¿é—®æƒé™**
   - æ£€æŸ¥ host é…ç½®æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤é˜²ç«å¢™å…è®¸ç›¸åº”ç«¯å£è®¿é—®
   - éªŒè¯ç»‘å®šæƒé™

3. **ä¾èµ–åŒ…é—®é¢˜**
   ```bash
   # é‡æ–°å®‰è£…ä¾èµ–
   pip install -r requirements.txt
   ```

### æœ¬åœ° LLM ç›¸å…³é—®é¢˜ ğŸ†•

1. **llama-cpp-python å®‰è£…å¤±è´¥**
   ```bash
   # Windows ç³»ç»Ÿå¯èƒ½éœ€è¦é¢å¤–å·¥å…·
   # å®‰è£… Microsoft C++ Build Tools
   # æˆ–è€…ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼š
   pip install llama-cpp-python --only-binary=llama-cpp-python
   ```

2. **æ¨¡å‹åŠ è½½å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   python -c "
   import os
   model_path = './models/your-model.gguf'
   if os.path.exists(model_path):
       size_gb = os.path.getsize(model_path) / (1024**3)
       print(f'æ¨¡å‹æ–‡ä»¶å­˜åœ¨ï¼Œå¤§å°: {size_gb:.2f} GB')
   else:
       print('æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°ä¸‹è½½')
   "
   
   # æµ‹è¯•æ¨¡å‹å…¼å®¹æ€§
   python -c "
   try:
       from llama_cpp import Llama
       print('llama-cpp-python å·²æ­£ç¡®å®‰è£…')
   except ImportError:
       print('llama-cpp-python æœªå®‰è£…æˆ–å®‰è£…æœ‰é—®é¢˜')
   "
   ```

3. **å†…å­˜ä¸è¶³é”™è¯¯**
   ```bash
   # é€‰æ‹©æ›´å°çš„æ¨¡å‹æˆ–è°ƒæ•´å‚æ•°
   # åœ¨ config.yaml ä¸­ï¼š
   # n_ctx: 2048      # å‡å°‘ä¸Šä¸‹æ–‡é•¿åº¦
   # n_batch: 256     # å‡å°‘æ‰¹å¤„ç†å¤§å°
   ```

4. **æ¨ç†é€Ÿåº¦è¿‡æ…¢**
   ```bash
   # æ£€æŸ¥ CPU ä½¿ç”¨æƒ…å†µå¹¶è°ƒæ•´çº¿ç¨‹æ•°
   # åœ¨ config.yaml ä¸­ï¼š
   # n_threads: 8     # è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°
   # use_mlock: true  # é”å®šå†…å­˜æé«˜æ€§èƒ½
   ```

5. **CUDA/GPU ç›¸å…³é—®é¢˜**
   ```bash
   # æ£€æŸ¥ CUDA æ˜¯å¦å¯ç”¨
   python -c "
   try:
       import torch
       print(f'CUDA å¯ç”¨: {torch.cuda.is_available()}')
       if torch.cuda.is_available():
           print(f'CUDA è®¾å¤‡æ•°: {torch.cuda.device_count()}')
   except ImportError:
       print('PyTorch æœªå®‰è£…ï¼Œæ— æ³•æ£€æŸ¥ CUDA')
   "
   
   # å¦‚æœ CUDA ä¸å¯ç”¨ï¼Œè®¾ç½®ä»…ä½¿ç”¨ CPU
   # n_gpu_layers: 0
   ```

6. **é…ç½®æ£€æŸ¥å’Œæµ‹è¯•**
   ```bash
   # è¿è¡Œé…ç½®æ£€æŸ¥ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹æœ¬åœ° LLM é—®é¢˜
   python check.py
   
   # ä½¿ç”¨æ¨¡å‹ä¸‹è½½å·¥å…·é‡æ–°é…ç½®
   python download_model.py
   ```

### ç›‘æ§å’Œæ€§èƒ½

#### ç›‘æ§é¢æ¿ç¤ºä¾‹è„šæœ¬
åˆ›å»ºä¸€ä¸ªç®€å•çš„ç›‘æ§è„šæœ¬ï¼š

```bash
#!/bin/bash
# monitor.sh - ç®€å•çš„APIç›‘æ§è„šæœ¬

API_URL="http://localhost:8000"

echo "ğŸ” æ£€æŸ¥ç¨‹åºçŠ¶æ€..."

# å¥åº·æ£€æŸ¥
health=$(curl -s "$API_URL/health" | jq -r '.status')
if [ "$health" = "healthy" ]; then
    echo "âœ… ç¨‹åºå¥åº·çŠ¶æ€: $health"
else
    echo "âŒ ç¨‹åºå¥åº·æ£€æŸ¥å¤±è´¥"
    exit 1
fi

# è·å–ç»Ÿè®¡ä¿¡æ¯
stats=$(curl -s "$API_URL/stats")
total_events=$(echo $stats | jq -r '.database_stats.total_events')
heartbeat_count=$(echo $stats | jq -r '.heartbeat_status.send_count')

echo "ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:"
echo "   æ€»äº‹ä»¶æ•°: $total_events"
echo "   å¿ƒè·³åŒ…å‘é€æ¬¡æ•°: $heartbeat_count"

# å¿ƒè·³åŒ…çŠ¶æ€
heartbeat_status=$(curl -s "$API_URL/heartbeat/status")
heartbeat_running=$(echo $heartbeat_status | jq -r '.running')
heartbeat_errors=$(echo $heartbeat_status | jq -r '.error_count')

echo "ğŸ’— å¿ƒè·³åŒ…çŠ¶æ€:"
echo "   è¿è¡ŒçŠ¶æ€: $heartbeat_running"
echo "   é”™è¯¯æ¬¡æ•°: $heartbeat_errors"

echo "âœ… ç›‘æ§æ£€æŸ¥å®Œæˆ"
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
chmod +x monitor.sh
./monitor.sh
```

### æœ€ä½³å®è·µ

#### ç›‘æ§é…ç½®å»ºè®®
- å¿ƒè·³åŒ…é—´éš”å»ºè®®è®¾ç½®ä¸º 60-300 ç§’
- é…ç½®å¤šä¸ªç›‘æ§æœåŠ¡ä»¥æé«˜å¯é æ€§
- è®¾ç½®é€‚å½“çš„è¶…æ—¶æ—¶é—´

#### API å®‰å…¨å»ºè®®
- åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨åå‘ä»£ç†
- é…ç½®é€‚å½“çš„è®¿é—®æ§åˆ¶
- è€ƒè™‘æ·»åŠ èº«ä»½éªŒè¯

#### æ€§èƒ½ä¼˜åŒ–
- æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´å‘é€é—´éš”
- ç›‘æ§ API å“åº”æ—¶é—´
- å®šæœŸæ£€æŸ¥å†…å­˜å’ŒCPUä½¿ç”¨æƒ…å†µ

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦æé†’**: 
1. **é…ç½®æ–‡ä»¶å®‰å…¨**: `config.yaml` åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå·²åœ¨ `.gitignore` ä¸­æ’é™¤
2. **API å¯†é’¥å®‰å…¨**: è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„ API å¯†é’¥ï¼Œä¸è¦åˆ†äº«æˆ–æäº¤åˆ°å…¬å…±ä»“åº“
3. **åº”ç”¨ä¸“ç”¨å¯†ç **: CalDAV å»ºè®®ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç è€Œéä¸»å¯†ç 
4. **Webhook å®‰å…¨**: ç¡®ä¿ Webhook ç«¯ç‚¹çš„å®‰å…¨æ€§å’Œè®¿é—®æ§åˆ¶
5. **ç½‘ç»œå®‰å…¨**: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ HTTPS

### é…ç½®æ–‡ä»¶ç®¡ç†
```bash
# ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œå¤åˆ¶ç¤ºä¾‹é…ç½®
cp config.yaml.example config.yaml

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆæ·»åŠ æ‚¨çš„çœŸå®å‡­æ®ï¼‰
nano config.yaml

# config.yaml ä¸ä¼šè¢«æäº¤åˆ° gitï¼ˆå·²åœ¨ .gitignore ä¸­ï¼‰
```

1. **API å¯†é’¥å®‰å…¨**: ä¸è¦å°† API å¯†é’¥æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
2. **åº”ç”¨ä¸“ç”¨å¯†ç **: CalDAV å»ºè®®ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç è€Œéä¸»å¯†ç 
3. **Webhook å®‰å…¨**: ç¡®ä¿ Webhook ç«¯ç‚¹çš„å®‰å…¨æ€§
4. **ç½‘ç»œå®‰å…¨**: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ HTTPS

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘ç¯å¢ƒè®¾ç½®

1. Fork è¿™ä¸ªä»“åº“
2. åˆ›å»ºæ‚¨çš„åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. å®‰è£…å¼€å‘ä¾èµ– (`pip install -r requirements.txt`)
4. å¤åˆ¶å¹¶é…ç½® `config.yaml` (`cp config.yaml.example config.yaml`)
5. è¿è¡Œå®Œæ•´æ€§æ£€æŸ¥ (`python check.py`)
6. æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
7. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
8. å¼€å¯ä¸€ä¸ª Pull Request

### ä»£ç è§„èŒƒ

- éµå¾ª PEP 8 Python ä»£ç è§„èŒƒ
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£å­—ç¬¦ä¸²
- åœ¨æäº¤å‰è¿è¡Œ `python check.py` ç¡®ä¿æ‰€æœ‰æ£€æŸ¥é€šè¿‡
- ä¿æŒæ•æ„Ÿä¿¡æ¯ä¸è¢«æäº¤ï¼ˆä½¿ç”¨ .gitignoreï¼‰

## ğŸ“„ è®¸å¯è¯

MIT License

## ï¿½ å¸¸è§é—®é¢˜ (FAQ)

### æœ¬åœ° LLM ç›¸å…³é—®é¢˜

#### Q1: æœ¬åœ°æ¨¡å‹å“åº”æ ¼å¼é”™è¯¯æ€ä¹ˆåŠï¼Ÿ

**é—®é¢˜**: æœ¬åœ° LLM æœ‰æ—¶ç”Ÿæˆçš„ JSON æ ¼å¼ä¸è§„èŒƒï¼Œå¯¼è‡´è§£æå¤±è´¥å’Œäº‹ä»¶æé†’å¤±æ•ˆã€‚

**âš ï¸ é‡è¦è­¦å‘Š**ï¼š
- æœ¬åœ°æ¨¡å‹çº¦æœ‰ **30-50%** çš„æ¦‚ç‡ç”Ÿæˆé”™è¯¯æ ¼å¼
- å¯èƒ½å¯¼è‡´é‡è¦äº‹ä»¶**æ— æ³•æ­£ç¡®åˆ†æå’Œæé†’**
- ç”Ÿäº§ç¯å¢ƒå¼ºçƒˆå»ºè®®ä½¿ç”¨äº‘ç«¯ LLM

**è§£å†³æ–¹æ¡ˆ**: Chrona v3.0 å·²å†…ç½®æ™ºèƒ½å®¹é”™æœºåˆ¶ï¼š

1. **è‡ªåŠ¨ JSON æå–**: ä»å¤æ‚å“åº”ä¸­è‡ªåŠ¨æå– JSON å¯¹è±¡
2. **å®¹é”™è§£æ**: JSON æ ¼å¼é”™è¯¯æ—¶ä½¿ç”¨å…³é”®è¯åˆ†æ
3. **ä¼˜åŒ–æç¤ºè¯**: ä¸ºæœ¬åœ°æ¨¡å‹å®šåˆ¶æ›´ä¸¥æ ¼çš„è¾“å‡ºæ ¼å¼è¦æ±‚
4. **å›é€€æœºåˆ¶**: è§£æå¤±è´¥æ—¶åŸºäºè§„åˆ™è¿›è¡Œæ™ºèƒ½åˆ¤æ–­

**æœ¬åœ°æ¨¡å‹ä¼˜åŒ–é…ç½®**:
```yaml
llm:
  local:
    enabled: true
    model_path: "models/Qwen3-1.7B-Q4_K_M.gguf"
    temperature: 0.1  # æä½æ¸©åº¦æé«˜ç¨³å®šæ€§
    top_p: 0.6        # å¤§å¹…å‡å°‘éšæœºæ€§
    max_tokens: 300   # é™åˆ¶è¾“å‡ºé•¿åº¦
    repeat_penalty: 1.2  # é¿å…é‡å¤å†…å®¹
```

**æœ€ä½³å®è·µ**:
- ğŸŒŸ **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨ Geminiï¼ˆå…è´¹é¢åº¦å……è¶³ï¼‰æˆ– DeepSeekï¼ˆä»·æ ¼ä¾¿å®œï¼‰
- ğŸ§ª **æµ‹è¯•ç¯å¢ƒ**: å¯ä½¿ç”¨æœ¬åœ°æ¨¡å‹è¿›è¡Œå®éªŒï¼Œä½†éœ€å¯†åˆ‡ç›‘æ§è¾“å‡ºè´¨é‡
- ğŸ“Š **æ··åˆæ¨¡å¼**: é‡è¦æ—¥å†ä½¿ç”¨äº‘ç«¯ LLMï¼Œä¸€èˆ¬æ—¥å†ä½¿ç”¨æœ¬åœ°æ¨¡å‹

#### Q2: æœ¬åœ°æ¨¡å‹åŠ è½½é€Ÿåº¦æ…¢ï¼Ÿ

**ä¼˜åŒ–å»ºè®®**:
- ä½¿ç”¨ SSD å­˜å‚¨æ¨¡å‹æ–‡ä»¶
- å¢åŠ  `n_threads` å‚æ•°ï¼ˆCPU æ ¸å¿ƒæ•°ï¼‰
- å¯ç”¨ GPU åŠ é€Ÿï¼ˆè®¾ç½® `gpu_layers`ï¼‰
- é€‰æ‹©æ›´å°çš„é‡åŒ–æ¨¡å‹ï¼ˆå¦‚ Q4_K_Mï¼‰

#### Q3: ä¾èµ–å®‰è£…å¤±è´¥ï¼Ÿ

**Windows ç”¨æˆ·**:
```powershell
# 1. å®‰è£… Visual Studio Build Tools
# 2. å®‰è£… CMake
# 3. ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬
pip install llama-cpp-python --prefer-binary
```

**è¯¦ç»†è¯´æ˜**: å‚è€ƒ [models/README.md](models/README.md)

### CalDAV è¿æ¥é—®é¢˜

#### Q4: CalDAV è®¤è¯å¤±è´¥ï¼Ÿ

**å¸¸è§åŸå› **:
1. å¯†ç é”™è¯¯ï¼ˆéœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼‰
2. URL æ ¼å¼ä¸æ­£ç¡®
3. æœåŠ¡å™¨ä¸æ”¯æŒ CalDAV

**è§£å†³æ­¥éª¤**:
```bash
# æµ‹è¯•é…ç½®
python check.py
```

#### Q5: å¤šä¸ªæ—¥å†æœåŠ¡éƒ¨åˆ†å¤±è´¥ï¼Ÿ

Chrona æ”¯æŒå®¹é”™å¤„ç†ï¼Œå•ä¸ªæœåŠ¡å¤±è´¥ä¸å½±å“å…¶ä»–æœåŠ¡ï¼š

```yaml
caldav:
  providers:
    working_service:     # æ­£å¸¸å·¥ä½œçš„æœåŠ¡
      url: "https://caldav.icloud.com"
      # ...
    
    failing_service:     # å³ä½¿æ­¤æœåŠ¡å¤±è´¥
      url: "https://broken-service.com"
      # ...
```

**æ—¥å¿—æŸ¥çœ‹**: æ£€æŸ¥ç»ˆç«¯è¾“å‡ºä¸­çš„é”™è¯¯ä¿¡æ¯

### Webhook é…ç½®é—®é¢˜

#### Q6: Webhook ä¸è§¦å‘ï¼Ÿ

**æ£€æŸ¥åˆ—è¡¨**:
- [ ] URL æ˜¯å¦å¯è®¿é—®
- [ ] HTTP æ–¹æ³•æ˜¯å¦æ­£ç¡®
- [ ] ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
- [ ] æœåŠ¡å™¨æ˜¯å¦è¿”å› 200 çŠ¶æ€ç 

**æµ‹è¯•æ–¹æ³•**:
```bash
# æ‰‹åŠ¨æµ‹è¯• webhook
curl -X POST -H "Content-Type: application/json" \
  -d '{"test": "message"}' \
  https://your-webhook-url.com
```

### æ€§èƒ½ä¼˜åŒ–

#### Q7: ç³»ç»Ÿèµ„æºå ç”¨é«˜ï¼Ÿ

**ä¼˜åŒ–é…ç½®**:
```yaml
# å‡å°‘æ£€æŸ¥é¢‘ç‡
check_interval: 300  # 5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡

# æœ¬åœ°æ¨¡å‹ä¼˜åŒ–
llm:
  local:
    context_length: 1024  # å‡å°‘ä¸Šä¸‹æ–‡é•¿åº¦
    gpu_layers: 0         # å…³é—­ GPUï¼ˆå¦‚æœä¸éœ€è¦ï¼‰
```

#### Q8: æ—¥ç¨‹åˆ†æå¤ªæ…¢ï¼Ÿ

**å»ºè®®**:
1. ä½¿ç”¨äº‘ç«¯ LLMï¼ˆGemini/DeepSeekï¼‰è·å¾—æ›´å¿«å“åº”
2. ä¼˜åŒ–æœ¬åœ°æ¨¡å‹å‚æ•°ï¼š
   ```yaml
   temperature: 0.1      # é™ä½éšæœºæ€§ï¼ŒåŠ å¿«ç”Ÿæˆ
   max_tokens: 300       # å‡å°‘è¾“å‡ºé•¿åº¦
   ```

### è°ƒè¯•å’Œæ—¥å¿—

#### Q9: å¦‚ä½•å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼Ÿ

```yaml
# å¯ç”¨è¯¦ç»†æ—¥å¿—
llm:
  local:
    verbose: true

# æˆ–åœ¨å¯åŠ¨æ—¶
python agent.py --verbose
```

#### Q10: å¦‚ä½•æŠ¥å‘Šé—®é¢˜ï¼Ÿ

æäº¤ Issue æ—¶è¯·åŒ…å«ï¼š
1. å®Œæ•´çš„é”™è¯¯æ—¥å¿—
2. é…ç½®æ–‡ä»¶ï¼ˆåˆ é™¤æ•æ„Ÿä¿¡æ¯ï¼‰
3. ç³»ç»Ÿç¯å¢ƒä¿¡æ¯
4. é‡ç°æ­¥éª¤

**è·å–ç³»ç»Ÿä¿¡æ¯**:
```bash
python check.py --verbose
```

## ï¿½ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·åˆ›å»º Issue æˆ–è”ç³»ç»´æŠ¤è€…ã€‚

## ğŸ“š æ›´å¤šæ–‡æ¡£

- âš™ï¸ [é…ç½®æ–‡ä»¶æ¨¡æ¿](config.yaml.example) - é…ç½®æ–‡ä»¶ç¤ºä¾‹å’Œè¯´æ˜
- ğŸ¤– [æœ¬åœ°æ¨¡å‹æŒ‡å—](models/README.md) - æœ¬åœ° LLM è¯¦ç»†é…ç½®è¯´æ˜

---

**ğŸ‰ Chrona v3.0 - è®©æ‚¨çš„æ—¥ç¨‹ç®¡ç†æ›´æ™ºèƒ½ã€æ›´å¯é ï¼**
